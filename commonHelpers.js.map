{"version":3,"file":"commonHelpers.js","sources":["../src/js/options.js","../src/js/render-functions.js","../src/js/utills.js","../src/js/dom-elements.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["const baseIziToastOptions = {\n  error: {\n    position: 'topRight',\n    class: 'error',\n    color: 'white',\n    timeout: 3000,\n  },\n  info: {\n    position: 'topRight',\n    timeout: 3000,\n  },\n};\n\nexport const MASSAGES = {\n  loading: 'Loading images, please wait...',\n  no_data: 'Sorry, there are no images matching your search query. Please try again!',\n  request_error: 'Error during requesting',\n  end_of_search: 'We\\'re sorry, but you\\'ve reached the end of search results.',\n};\n\nexport const iziToastOptions = {\n  error_no_data: {\n    message: MASSAGES.no_data,\n    ...baseIziToastOptions.error,\n  },\n  request_error: {\n    message: MASSAGES.request_error,\n    ...baseIziToastOptions.error,\n  },\n  end_of_search: {\n    message: MASSAGES.end_of_search,\n    ...baseIziToastOptions.info,\n  },\n};","export function getLoadMoreBtnEl() {\n  const btn = document.createElement('button');\n  btn.textContent = 'Load More';\n  btn.classList.add('btn');\n\n  return btn;\n}\n\nexport function getLoader(text) {\n  const loader = document.createElement('div');\n  loader.textContent = text;\n  loader.classList.add('loader');\n\n  return loader;\n}\n\nexport function getImagesEl(imagesList) {\n  return imagesList.reduce((string, element) => {\n    string += getImageEl(element);\n    return string;\n  }, '');\n}\n\nfunction getImageEl(image) {\n  const {\n    id,\n    webformatURL: previewSrc,\n    largeImageURL: originalSrc,\n    tags: alt,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = image;\n\n  return `\n    <div data-image-id=\"${id}\" class=\"image\">\n      <a class=\"image-link\" href=\"${originalSrc}\">\n        <div class=\"image-photo-wrap\"><img class=\"image-photo\" src=\"${previewSrc}\" data-source=\"${originalSrc}\" alt=\"${alt}\"/></div>\n        <div class=\"image-data\">\n          <div class=\"image-data-item image-data-item-likes\"><div class=\"image-data-item-label\">Likes</div><div class=\"image-data-item-number\">${likes}</div></div>\n          <div class=\"image-data-item image-data-item-views\"><div class=\"image-data-item-label\">Views</div><div class=\"image-data-item-number\">${views}</div></div>\n          <div class=\"image-data-item image-data-item-comments\"><div class=\"image-data-item-label\">Comments</div><div class=\"image-data-item-number\">${comments}</div></div>\n          <div class=\"image-data-item image-data-item-downloads\"><div class=\"image-data-item-label\">Downloads</div><div class=\"image-data-item-number\">${downloads}</div></div>\n      </div>\n      </a>\n    </div>\n  `;\n}","export function getFirstIdFromPixabayData(data) {\n  return data[0]['id'] ?? null;\n}\n\nexport function scrollToElementById(elementId) {\n  const elementsToScroll = document.querySelectorAll(`[data-image-id=\"${elementId}\"]`);\n\n  if (!elementsToScroll) return;\n\n  const elementToScroll = elementsToScroll[elementsToScroll.length - 1];\n\n  setTimeout(() => {\n    elementToScroll.scrollIntoView({ behavior: 'smooth', block: 'start' });\n  }, 200);\n}","import { getLoader, getLoadMoreBtnEl } from './render-functions.js';\nimport { MASSAGES } from './options.js';\n\nexport const formEl = document.querySelector('#search-form');\nexport const loaderEl = getLoader(MASSAGES.loading);\nexport const imagesEl = document.querySelector('#images');\nexport const loadMoreBtnEl = getLoadMoreBtnEl();\nexport const searchStringInput = formEl.querySelector('input[name=\"search\"]');","import { iziToastOptions } from './options.js';\nimport { getImagesEl } from './render-functions.js';\nimport { getFirstIdFromPixabayData, scrollToElementById } from './utills.js';\nimport { formEl, imagesEl, loadMoreBtnEl } from './dom-elements.js';\nimport axios from 'axios';\n\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nlet lightbox;\nlet pagCurrentPage = 1;\nconst pagPerPage = 15;\n\nfunction enableLightbox() {\n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    lightbox = new SimpleLightbox('#images .image-link', {\n      captions: true,\n      captionsData: 'alt',\n      captionPosition: 'bottom',\n      captionDelay: 250,\n    });\n  }\n}\n\nasync function getPixabayResponse(searchString) {\n  return await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: '43799735-9794f2fe47020c8ff64ba54b4',\n      q: searchString,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: pagCurrentPage,\n      per_page: pagPerPage,\n    },\n  });\n}\n\nasync function imagesAction(searchString, isNewSearch = false) {\n  if (isNewSearch) {\n    pagCurrentPage = 1;\n    imagesEl.innerHTML = '';\n  }\n\n  try {\n    const pixabay = await getPixabayResponse(searchString);\n    const { hits, totalHits } = pixabay.data;\n\n    if (totalHits < 1) {\n      iziToast.error(iziToastOptions.error_no_data);\n      formEl.reset();\n      return;\n    }\n\n    const idToScroll = getFirstIdFromPixabayData(hits);\n    const totalPages = Math.ceil(totalHits / pagPerPage);\n    loadMoreBtnEl.remove();\n\n    if (isNewSearch) {\n      imagesEl.innerHTML = getImagesEl(hits);\n    } else {\n      imagesEl.insertAdjacentHTML('beforeend', getImagesEl(hits));\n    }\n\n    if (idToScroll) {\n      scrollToElementById(idToScroll);\n    }\n\n    if (pagCurrentPage < totalPages) {\n      imagesEl.appendChild(loadMoreBtnEl);\n      pagCurrentPage++;\n    } else {\n      if (!isNewSearch) {\n        iziToast.info(iziToastOptions.end_of_search);\n      }\n\n      formEl.reset();\n      pagCurrentPage = 1;\n    }\n\n    enableLightbox();\n  } catch (error) {\n    console.log(error);\n    iziToast.error(iziToastOptions.request_error);\n  }\n}\n\nexport default imagesAction;","import imagesAction from './js/pixabay-api.js';\nimport { formEl, loaderEl, imagesEl, searchStringInput, loadMoreBtnEl } from './js/dom-elements.js';\n\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\ndocument.addEventListener('DOMContentLoaded', event => {\n  formEl.addEventListener('submit', async event => {\n    event.preventDefault();\n\n    formEl.after(loaderEl);\n    const searchString = searchStringInput.value;\n\n    await imagesAction(searchString, true);\n\n    loaderEl.remove();\n  });\n\n  loadMoreBtnEl.addEventListener('click', async () => {\n    const searchString = searchStringInput.value;\n\n    loadMoreBtnEl.classList.add('loading');\n\n    await imagesAction(searchString);\n\n    loadMoreBtnEl.classList.remove('loading');\n  });\n});"],"names":["baseIziToastOptions","MASSAGES","iziToastOptions","getLoadMoreBtnEl","btn","getLoader","text","loader","getImagesEl","imagesList","string","element","getImageEl","image","id","previewSrc","originalSrc","alt","likes","views","comments","downloads","getFirstIdFromPixabayData","data","scrollToElementById","elementId","elementsToScroll","elementToScroll","formEl","loaderEl","imagesEl","loadMoreBtnEl","searchStringInput","lightbox","pagCurrentPage","pagPerPage","enableLightbox","SimpleLightbox","getPixabayResponse","searchString","axios","imagesAction","isNewSearch","pixabay","hits","totalHits","iziToast","idToScroll","totalPages","error","event"],"mappings":"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"}